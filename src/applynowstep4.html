<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- FontAwesome for Icons -->
    <script src="https://kit.fontawesome.com/e588cb9d47.js"
      crossorigin="anonymous"></script>
    <link rel="icon" type="image/png"
      href="path/images/logocoop-removebg-preview 2.png">
    <!-- SweetAlert2 with custom CSS import -->
    <link rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href="./output.css" rel="stylesheet">
    <link href="../src/animation/animation.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Apply Now Step 4 | GBLDC</title>
  </head>

  <body class="bg-gray-50 font-sans antialiased">
    <!-- Header Section -->
    <header
      class="bg-white shadow-lg lg:shadow-md fixed left-0 top-0 z-50 w-full">
      <div class="container-lg mx-auto flex justify-between items-center p-4">
        <!-- Logo and Title -->
        <div
          class="flex items-center space-x-2 sm:space-x-4 overflow-hidden flex-1 min-w-0">
          <a href="landingpage.html" class="flex-shrink-0">
            <img src="path/images/logocoop-removebg-preview 2.png"
              alt="GBLDC Logo"
              class="w-12 h-12 sm:w-16 sm:h-14 lg:w-18 lg:h-16 bg-auto">
          </a>
          <h1
            class="text-xs sm:text-base md:text-lg lg:text-xl font-medium animate-fade-in-right truncate">
            Greater Bulacan Livelihood Development Cooperative
          </h1>
        </div>

        <!-- Desktop Navigation -->
        <nav
          class="hidden lg:flex space-x-4 xl:space-x-4 text-black font-normal tracking-normal mr-8 xl:mr-36">
          <a href="landingpage.html"
            class="hover:text-green-600 transition-colors duration-300 whitespace-nowrap">
            HOME
          </a>

          <!-- Products & Services Dropdown -->
          <div class="relative" id="dropdown-trigger">
            <a href="#"
              class="hover:text-green-600 flex items-center transition-colors duration-300 whitespace-nowrap"
              onclick="toggleDropdownProducts(event)">
              PRODUCT & SERVICES
              <span class="ml-1"><i class="fas fa-chevron-down"></i></span>
            </a>
            <div
              class="dropdown-menu absolute left-0 hidden bg-slate-50 p-3 rounded-lg shadow-xl mt-2 w-64 transition-all duration-100 ease-in-out animate-fade-in animate_faster"
              id="dropdown-menu-products">
              <a href="loan-products.html"
                class="block px-4 py-2 hover:bg-green-200 rounded-md transition-colors duration-200">
                Loans
              </a>
              <a href="deposit.html"
                class="block px-4 py-2 hover:bg-green-200 rounded-md transition-colors duration-200">
                Deposits
              </a>
              <a href="insurance.html"
                class="block px-4 py-2 hover:bg-green-200 rounded-md transition-colors duration-200">
                Insurance
              </a>
              <a href="social-services.html"
                class="block px-4 py-2 hover:bg-green-200 rounded-md transition-colors duration-200">
                Social Services
              </a>
            </div>
          </div>

          <!-- About Dropdown -->
          <div class="relative" id="dropdown-trigger-about">
            <a href="#"
              class="hover:text-green-600 flex items-center transition-colors duration-300 whitespace-nowrap"
              onclick="toggleDropdown(event)">
              ABOUT
              <span class="ml-1"><i class="fas fa-chevron-down"></i></span>
            </a>
            <div
              class="dropdown-menu absolute left-0 hidden bg-slate-50 p-3 rounded-lg shadow-xl mt-2 w-64 transition-all duration-100 ease-in-out animate-fade-in animate_faster"
              id="dropdown-menu">
              <a href="about-gbldc.html"
                class="block px-4 py-2 hover:bg-green-200 rounded-md transition-colors duration-200">
                About GBLDC
              </a>
              <a href="#"
                class="block px-4 py-2 hover:bg-green-200 rounded-md transition-colors duration-200">
                Mission & Vision
              </a>
              <a href="board-of-directors.html"
                class="block px-4 py-2 hover:bg-green-200 rounded-md transition-colors duration-200">
                Board of Directors
              </a>
              <a href="committee-officers.html"
                class="block px-4 py-2 hover:bg-green-200 rounded-md transition-colors duration-200">
                Committee Officers
              </a>
            </div>
          </div>

          <a href="news&events.html"
            class="hover:text-green-600 transition-colors duration-300 whitespace-nowrap">
            NEWS & EVENTS
          </a>
        </nav>

        <!-- Desktop Buttons -->
        <div class="hidden lg:flex items-center gap-3 xl:gap-4">
          <a href="index.html"
            class="bg-green-500 text-white px-4 xl:px-7 py-2 hover:bg-green-600 rounded-md font-normal whitespace-nowrap text-sm xl:text-base">
            Login
          </a>
          <a href="applynow.html"
            class="border border-green-600 text-black px-4 xl:px-6 py-2 rounded-md font-normal hover:bg-green-50 whitespace-nowrap text-sm xl:text-base">
            Apply Now
          </a>
        </div>

        <!-- Tablet Buttons (hidden on mobile and desktop) -->
        <div class="hidden md:flex lg:hidden items-center gap-2">
          <a href="index.html"
            class="bg-green-500 text-white px-3 py-2 hover:bg-green-600 rounded-md font-normal text-sm">
            Login
          </a>
          <a href="applynow.html"
            class="border border-green-600 text-black px-3 py-2 rounded-md font-normal hover:bg-green-50 text-sm">
            Apply
          </a>
        </div>

        <!-- Mobile Menu Button -->
        <button
          class="lg:hidden text-black focus:outline-none animate-fade-in ml-2 flex-shrink-0"
          onclick="toggleMobileMenu()">
          <i class="fas fa-bars text-xl sm:text-2xl"></i>
        </button>
      </div>

      <!-- Mobile Navigation -->
      <nav class="lg:hidden bg-white shadow-lg hidden" id="mobile-menu">
        <div class="px-4 py-2 space-y-1">
          <a href="landingpage.html"
            class="block px-4 py-3 hover:bg-green-200 transition-colors duration-200 rounded-md">
            HOME
          </a>

          <!-- Mobile Products & Services Dropdown -->
          <div class="relative">
            <a href="#"
              class="flex px-4 py-3 hover:bg-green-200 items-center justify-between transition-colors duration-200 rounded-md"
              onclick="toggleDropdownProductsMobile(event)">
              <span>PRODUCT & SERVICES</span>
              <i class="fas fa-chevron-down transition-transform duration-200"
                id="products-arrow"></i>
            </a>
            <div
              class="hidden bg-slate-50 rounded-md shadow-xl mt-1 overflow-hidden"
              id="dropdown-menu-products-mobile">
              <a href="loan-products.html"
                class="block px-8 py-2 hover:bg-green-200 transition-colors duration-200">
                Loans
              </a>
              <a href="deposit.html"
                class="block px-8 py-2 hover:bg-green-200 transition-colors duration-200">
                Deposits
              </a>
              <a href="insurance.html"
                class="block px-8 py-2 hover:bg-green-200 transition-colors duration-200">
                Insurance
              </a>
              <a href="social-services.html"
                class="block px-8 py-2 hover:bg-green-200 transition-colors duration-200">
                Social Services
              </a>
            </div>
          </div>

          <!-- Mobile About Dropdown -->
          <div class="relative">
            <a href="#"
              class="flex px-4 py-3 hover:bg-green-200 items-center justify-between transition-colors duration-200 rounded-md"
              onclick="toggleDropdownMobileAbout(event)">
              <span>ABOUT</span>
              <i class="fas fa-chevron-down transition-transform duration-200"
                id="about-arrow"></i>
            </a>
            <div
              class="hidden bg-slate-50 rounded-md shadow-xl mt-1 overflow-hidden"
              id="dropdown-menu-about-mobile">
              <a href="about-gbldc.html"
                class="block px-8 py-2 hover:bg-green-200 transition-colors duration-200">
                About GBLDC
              </a>
              <a href="#"
                class="block px-8 py-2 hover:bg-green-200 transition-colors duration-200">
                Mission & Vision
              </a>
              <a href="board-of-directors.html"
                class="block px-8 py-2 hover:bg-green-200 transition-colors duration-200">
                Board of Directors
              </a>
              <a href="committee-officers.html"
                class="block px-8 py-2 hover:bg-green-200 transition-colors duration-200">
                Committee Officers
              </a>
            </div>
          </div>

          <a href="news&events.html"
            class="block px-4 py-3 hover:bg-green-200 transition-colors duration-200 rounded-md">
            NEWS & EVENTS
          </a>

          <!-- Mobile Buttons -->
          <div class="flex flex-col items-stretch mt-4 space-y-2 px-4 pb-4">
            <a href="index.html"
              class="bg-green-600 text-white px-4 py-3 rounded-lg font-normal hover:bg-green-800 text-center transition-colors duration-200">
              Login
            </a>
            <a href="applynow.html"
              class="border border-green-600 text-black px-4 py-3 rounded-lg font-normal hover:bg-green-50 text-center transition-colors duration-200">
              Apply Now
            </a>
          </div>
        </div>
      </nav>
    </header>

    <!-- Main Content Apply Now Step 4 -->
    <section>
      <div class="max-w-4xl mx-auto mt-24 p-7 ">
        <h2 class="text-center text-4xl font-semibold text-gray-800">Online
          Application</h2>
        <p class="text-center text-bl mt-3">Let’s talks and learn your finances
          better</p>
        <div class="flex items-center justify-center my-6">
          <div class="flex items-center gap-8">
            <div class="flex flex-col items-center text-black">
              <a href ="#" onclick="validateStep4(event)">
                <div
                  class="w-12 h-12 flex items-center justify-center bg-gray-200 rounded-full">
                  1
                </div>
              </a>
              <a href>
                <p class="text-sm mt-2 text-center">Personal Information</p>
              </a>
            </div>
            <div class="w-20 h-1 bg-green-300"></div>
            <div class="flex flex-col items-center text-black">
              <a href="#" onclick="validateStep4(event)">
                <div
                  class="w-12 h-12 flex items-center justify-center bg-gray-200 rounded-full">
                  2
                </div>
              </a>
              <p class="text-sm mt-2 text-center">Emergency Contact 1</p>
            </div>
            <div class="w-20 h-1 bg-green-300"></div>
            <div class="flex flex-col items-center text-black">
              <a href="#" onclick="validateStep4(event)">
                <div
                  class="w-12 h-12 flex items-center justify-center bg-gray-200 rounded-full">
                  3
                </div>
              </a>
              <p class="text-sm mt-2 text-center">Emergency Contact 2</p>
            </div>
            <div class="w-20 h-1 bg-gray-300"></div>
            <div class="flex flex-col items-center text-black">
              <a href="#" onclick="validateStep4(event)">
              <div
                class="w-12 h-12 flex items-center justify-center bg-green-300 rounded-full">
                4
              </div>
              </a>
              <p class="text-sm mt-2 text-center">Employment Information</p>
            </div>
          </div>
        </div>
      </section>
      <div
        class="max-w-7xl mx-auto bg-white p-7 shadow-lg rounded-lg mt-6 mb-10">
        <form action="#" method="POST"
          class="space-y-6 font-normal max-w-7xl mx-auto p-11"
          id="employmentForm">
          <h3 class="text-2xl font-medium text-teal-900">Employment
            Information</h3>
          <p class="text-sm text-gray-600">Please provide your employment
            information to help us understand your financial background.</p>
          <div class="grid md:grid-cols-2 gap-6">
            <div>
              <label class="block text-normal font-medium mb-1">Employment
                Status
                <span class="text-red-500">*</span></label>
              <select
                class="w-full border rounded px-3 py-2  focus:outline-none focus:ring-2 focus:ring-green-400">
                <option>Select</option>
                <option>Employed</option>
                <option>Self-Employed</option>
                <option>Unemployed</option>
                <option>Retired</option>
                <option>Student</option>
                <option>Freelancer</option>
                <option>OFW</option>
                <option>Part-Time</option>
                <option>Contractual</option>
                <option>Seasonal</option>
                <option>Business Owner</option>
                <option>Homemaker</option>
                <option>Disabled</option>
                <option>Others</option>
              </select>
            </div>
            <div>
              <label class="block text-normal font-medium mb-1">Source of Funds
                <span class="text-red-500">*</span></label>
              <select
                class="w-full border rounded px-3 py-2  focus:outline-none focus:ring-2 focus:ring-green-400">
                <option>Select</option>
                <option>Salary</option>
                <option>Business</option>
                <option>Pension</option>
                <option>Remittance</option>
                <option>Investment</option>
                <option>Allowance</option>
                <option>Rental Income</option>
                <option>Others</option>
              </select>
            </div>
          </div>
          <div class="grid md:grid-cols-2 gap-6">
            <div>
              <label
                class="block text-normal font-medium mb-1">Employer/Business
                Name <span class="text-red-500">*</span></label>
              <input type="text"
                class="w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-400"
                placeholder="Employer/Business Name">
            </div>
            <div>
              <label class="block text-normal font-medium mb-1">Occupation <span
                  class="text-red-500">*</span></label>
              <select
                class="w-full border rounded px-3 py-2  focus:outline-none focus:ring-2 focus:ring-green-400">
                <option>Select Occupation</option>
                <option>Accountant</option>
                <option>Engineer</option>
                <option>Teacher</option>
                <option>Doctor</option>
                <option>Nurse</option>
                <option>Police Officer</option>
                <option>Firefighter</option>
                <option>Driver</option>
                <option>Salesperson</option>
                <option>Cashier</option>
                <option>Manager</option>
                <option>Clerk</option>
                <option>Farmer</option>
                <option>Fisherman</option>
                <option>Construction Worker</option>
                <option>Business Owner</option>
                <option>Self-Employed</option>
                <option>Student</option>
                <option>Retired</option>
                <option>Unemployed</option>
                <option>Others</option>
              </select>
            </div>
          </div>
          <div>
            <label class="block text-normal font-medium mb-1">Company/Business
              Address <span class="text-red-500">*</span></label>
            <input type="text"
              class="w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-400"
              placeholder="Company/Business Address">
          </div>
          <div class="grid md:grid-cols-2 gap-6">
            <div>
              <label class="block text-normal font-medium mb-1">Gross Monthly
                Income
                <span class="text-red-500">*</span></label>
              <select
                class="w-full border rounded  px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-400">
                <option>Select</option>
                <option>Below ₱10,000</option>
                <option>₱10,000 - ₱20,000</option>
                <option>₱20,001 - ₱30,000</option>
                <option>₱30,001 - ₱50,000</option>
                <option>₱50,001 - ₱100,000</option>
                <option>Above ₱100,000</option>
              </select>
            </div>
            <div>
              <label class="block text-normal font-medium mb-1">Nature/Type of
                Employment/Business <span class="text-red-500">*</span></label>
              <select
                class="w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-400">
                <option>Select</option>
                <option>Government</option>
                <option>Private</option>
                <option>Self-Employed</option>
                <option>OFW</option>
                <option>Freelancer</option>
                <option>Business Owner</option>
                <option>Retired</option>
                <option>Student</option>
                <option>Unemployed</option>
                <option>Non-Profit/NGO</option>
                <option>Contractual</option>
                <option>Part-Time</option>
                <option>Seasonal</option>
                <option>Others</option>
              </select>
            </div>
          </div>
          <div class="grid md:grid-cols-2 gap-6">
            <div>
              <label class="block text-normal font-medium mb-1">SSS/GSIS No.
                <span class="text-red-500">*</span></label>
              <input type="text"
                class="w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-400"
                placeholder="SSS/GSIS No.">
            </div>
            <div>
              <label class="block text-normal font-medium mb-1">TIN No. <span
                  class="text-red-500">*</span></label>
              <input type="text"
                class="w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-400"
                placeholder="TIN No.">
            </div>
          </div>
          <div class="pt-6 border-t">
            <h3 class="text-2xl font-medium mb-2 text-teal-900">Attachments</h3>
            <label class="block font-normal mb-1 text-normal">Required Documents
              <span class="text-red-500">*</span></label>
            <div class="flex items-center gap-3">
              <input type="text" id="docName"
                class="border px-3 py-2 rounded w-96 mt-3"
                placeholder="Required Documents" readonly>
              <input type="file" id="docFile"
                class="text-sm cursor-pointer file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100"
                accept="image/*">
              <button type="button" id="docRemove"
                class="hidden text-red-500 text-base">Remove</button>
              <button type="button" id="docReplace"
                class="hidden text-blue-500 text-base">Replace</button>
            </div>
            <img id="docPreview"
              class="mt-2 w-32 h-32 object-cover rounded border hidden" />
          </div>
          <div class="mt-6">
            <label class="block font-normal mb-1 text-normal">2x2 Picture <span
                class="text-red-500">*</span></label>
            <div class="flex items-center gap-3">
              <input type="text" id="picName"
                class="border px-3 py-2 rounded w-96 mt-3"
                placeholder="2x2 Picture" readonly>
              <input type="file" id="picFile"
                class="text-sm cursor-pointer file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100"
                accept="image/*">
              <button type="button" id="picRemove"
                class="hidden text-red-500  text-base">Remove</button>
              <button type="button" id="picReplace"
                class="hidden text-blue-500  text-base">Replace</button>
            </div>
            <img id="picPreview"
              class="mt-2 w-32 h-32 object-cover rounded border hidden" />
          </div>
          <div class="mt-6">
            <label class="block font-normal mb-1 text-normal">Proof of Billing
              <span class="text-red-500">*</span></label>
            <div class="flex items-center gap-3">
              <input type="text" id="billingName"
                class="border px-3 py-2 rounded w-96 mt-3"
                placeholder="Proof of Billing" readonly>
              <input type="file" id="billingFile"
                class="text-sm cursor-pointer file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100"
                accept="image/*">
              <button type="button" id="billingRemove"
                class="hidden text-red-500 text-base">Remove</button>
              <button type="button" id="billingReplace"
                class="hidden text-blue-500 text-base">Replace</button>
            </div>
            <img id="billingPreview"
              class="mt-2 w-32 h-32 object-cover rounded border hidden" />
          </div>
          <p class="text-sm text-gray-500 mt-2">Maximum upload file size:
            1MB</p>
          <!-- CAPTCHA Section -->
          <div class="mt-6">
            <!-- hCaptcha Widget -->
            <div class="mt-2">
              <div class="h-captcha"
                data-sitekey="4db0c162-5c22-405c-ba18-aa1ae5ee22c2"></div>
            </div>
              <!-- Terms and Conditions (full width) -->
                        <div class="md:col-span-2 flex items-start mt-10">
                            <input type="checkbox" id="terms" required
                                class="mt-1 mr-2">
                            <label for="terms" class="text-sm text-gray-700">I
                                confirm that all information provided is true
                                and I agree to the <a href="#"
                                    class="text-green-700 underline">Terms &
                                    Conditions</a> of GBLDC.</label>
                        </div>
            <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
            <div id="captchaError"
              class="text-red-500 text-sm mt-2 hidden">Please complete the
              CAPTCHA.</div>
            <div class="flex justify-end pt-6">
              <button type="submit"
                class="bg-green-600 text-white px-6 py-2 rounded-md font-normal hover:bg-green-700">Submit</button>
            </div>
          </div>
        </form>
        <script>
          // Show SweetAlert2 loading on submit, then success after 1.5s
          document.getElementById("employmentForm").addEventListener("submit", function (e) {
            var captcha = document.querySelector('textarea[name="h-captcha-response"]');
            var error = document.getElementById("captchaError");
            if (!captcha || !captcha.value) {
              // Let the other script handle error
              return;
            }
            e.preventDefault();
            Swal.fire({
              title: 'Submitting, please wait...',
              allowOutsideClick: false,
              didOpen: () => {
                Swal.showLoading();
              }
            });

            setTimeout(function () {
              Swal.fire({
                icon: 'success',
                title: 'Submitted successfully!',
                showConfirmButton: true,
                timer: 2000,
                timerProgressBar: true,
                didOpen: () => {
                  const progressBar = document.querySelector('.swal2-timer-progress-bar');
                  if (progressBar) {
                    progressBar.style.background = '#22c55e';
                  }
                },
                didClose: () => {
                  // Redirect to next step
                },
                backdrop: 'rgba(0, 0, 0, 0.5)',
                position: 'center',
                showClass: {
                  popup: 'animate__animated animate__fadeInDown'
                },
                hideClass: {
                  popup: 'animate__animated animate__fadeOutUp'
                },
                iconColor: '#5f995e'
              });
            }, 1500);
          });
        </script>
      </form>
      <script src="../src/javascript/dropdown.js"></script>
      <script>
          function previewImage(input, previewId, nameId, removeId, replaceId) {
            const file = input.files[0];
            if (!file) return;

            const preview = document.getElementById(previewId);
            const nameInput = document.getElementById(nameId);
            const removeBtn = removeId ? document.getElementById(removeId) : null;
            const replaceBtn = replaceId ? document.getElementById(replaceId) : null;

            const reader = new FileReader();
            reader.onload = function (e) {
              preview.src = e.target.result;
              preview.classList.remove("hidden");
              if (nameInput) nameInput.value = file.name;
              if (removeBtn) removeBtn.classList.remove("hidden");
              if (replaceBtn) replaceBtn.classList.remove("hidden");
              if (input) input.classList.add("hidden");
                // Make all attachment previews clickable for verification
                preview.style.cursor = "pointer";
                preview.title = "Click to view full size";
                preview.onclick = function () {
                // Show image in a modal using SweetAlert2 instead of opening a new window
                Swal.fire({
                  imageUrl: preview.src,
                  imageAlt: nameInput ? nameInput.value : "Attachment Preview",
                  showConfirmButton: true,
                  confirmButtonText: "Close",
                  width: 760,
                  padding: '1.5em',
                  background: '#fff',
                  customClass: {
                  popup: 'rounded-md shadow-lg',
                  confirmButton: 'text-white px-6 py-2 rounded-md font-normal'
                  }
                });
                };
              };
              reader.readAsDataURL(file);
              }

              function removeImage(previewId, nameId, fileId, removeId, replaceId) {
              const preview = document.getElementById(previewId);
              const nameInput = document.getElementById(nameId);
              const fileInput = document.getElementById(fileId);
              const removeBtn = removeId ? document.getElementById(removeId) : null;
              const replaceBtn = replaceId ? document.getElementById(replaceId) : null;

              preview.src = "";
              preview.classList.add("hidden");
              if (nameInput) nameInput.value = "";
              if (fileInput) {
                fileInput.value = "";
                fileInput.classList.remove("hidden");
              }
              if (removeBtn) removeBtn.classList.add("hidden");
              if (replaceBtn) replaceBtn.classList.add("hidden");
              // Remove click event for preview
              preview.style.cursor = "";
              preview.title = "";
              preview.onclick = null;
              }

              function replaceImage(fileId) {
              const fileInput = document.getElementById(fileId);
              if (fileInput) {
                fileInput.click();
              }
              }

              // --- Multiple Attachments for Required Documents ---
              // Container for previews
              const docFileInput = document.getElementById("docFile");
              const docNameInput = document.getElementById("docName");
              const docPreview = document.getElementById("docPreview");
              const docRemove = document.getElementById("docRemove");
              const docReplace = document.getElementById("docReplace");

              // Create a container for multiple previews if not exists
              let docPreviewContainer = document.getElementById("docPreviewContainer");
              if (!docPreviewContainer) {
              docPreviewContainer = document.createElement("div");
              docPreviewContainer.id = "docPreviewContainer";
              docPreviewContainer.className = "flex flex-wrap gap-3 mt-2";
              docPreview.parentNode.insertBefore(docPreviewContainer, docPreview.nextSibling);
              }

              // Hide the single preview image
              docPreview.style.display = "none";

              docFileInput.setAttribute("multiple", "multiple");

              docFileInput.addEventListener("change", function () {
              // Clear previous previews
              docPreviewContainer.innerHTML = "";
              docNameInput.value = "";
              const files = Array.from(this.files);
              if (files.length === 0) {
                docRemove.classList.add("hidden");
                docReplace.classList.add("hidden");
                return;
              }
              docRemove.classList.remove("hidden");
              docReplace.classList.remove("hidden");
              docNameInput.value = files.map(f => f.name).join(", ");

              files.forEach((file, idx) => {
                const reader = new FileReader();
                reader.onload = function (e) {
                const img = document.createElement("img");
                img.src = e.target.result;
                img.className = "w-32 h-32 object-cover rounded border cursor-pointer";
                img.title = file.name;
                img.alt = file.name;
                img.onclick = function () {
                  Swal.fire({
                  imageUrl: img.src,
                  imageAlt: file.name,
                  showConfirmButton: true,
                  confirmButtonText: "Close",
                  width: 760,
                  padding: '1.5em',
                  background: '#fff',
                  customClass: {
                    popup: 'rounded-lg shadow-lg',
                    confirmButton: 'bg-green-600 text-white px-6 py-2 rounded-md font-normal hover:bg-green-700'
                  }
                  });
                };
                docPreviewContainer.appendChild(img);
                };
                reader.readAsDataURL(file);
              });
              // Hide the file input after selection
              docFileInput.classList.add("hidden");
              });

              docRemove.addEventListener("click", function () {
              docPreviewContainer.innerHTML = "";
              docNameInput.value = "";
              docFileInput.value = "";
              docFileInput.classList.remove("hidden");
              docRemove.classList.add("hidden");
              docReplace.classList.add("hidden");
              });

              docReplace.addEventListener("click", function () {
              docFileInput.click();
              });

              // --- End Multiple Attachments ---

              // 2x2 Picture (single)
              document.getElementById("picFile").addEventListener("change", function () {
              previewImage(this, "picPreview", "picName", "picRemove", "picReplace");
              });
              document.getElementById("picRemove").addEventListener("click", function () {
              removeImage("picPreview", "picName", "picFile", "picRemove", "picReplace");
              });
              document.getElementById("picReplace").addEventListener("click", function () {
              replaceImage("picFile");
              });

              // Proof of Billing (single)
              document.getElementById("billingFile").addEventListener("change", function () {
              previewImage(this, "billingPreview", "billingName", "billingRemove", "billingReplace");
              });
              document.getElementById("billingRemove").addEventListener("click", function () {
              removeImage("billingPreview", "billingName", "billingFile", "billingRemove", "billingReplace");
              });
              document.getElementById("billingReplace").addEventListener("click", function () {
              replaceImage("billingFile");
              });

              // Show error if captcha not completed before submit
              document.getElementById("employmentForm").addEventListener("submit", function (e) {
              var captcha = document.querySelector('textarea[name="h-captcha-response"]');
              var error = document.getElementById("captchaError");
              if (!captcha || !captcha.value) {
                e.preventDefault();
                if (error) error.classList.remove("hidden");
                return false;
              } else {
                if (error) error.classList.add("hidden");
              }
              });
                // Function to validate step 4
                function validateStep4(event) {
                event.preventDefault();
                // Check required fields in Employment Information
                const form = document.getElementById("employmentForm");
                const requiredSelects = form.querySelectorAll("select");
                const requiredInputs = [
                  ...form.querySelectorAll('input[type="text"]:not([readonly])')
                ];
                let valid = true;

                // Validate selects (must not be "Select" or "Select Occupation")
                requiredSelects.forEach(sel => {
                  if (
                  sel.value === "Select" ||
                  sel.value === "Select Occupation" ||
                  sel.value.trim() === ""
                  ) {
                  sel.classList.add("ring-2", "ring-red-400");
                  valid = false;
                  } else {
                  sel.classList.remove("ring-2", "ring-red-400");
                  }
                });

                // Validate text inputs (must not be empty)
                requiredInputs.forEach(inp => {
                  if (inp.value.trim() === "") {
                  inp.classList.add("ring-2", "ring-red-400");
                  valid = false;
                  } else {
                  inp.classList.remove("ring-2", "ring-red-400");
                  }
                });

                // Validate file attachments (Required Documents, 2x2, Billing)
                const docFiles = document.getElementById("docFile").files;
                const picFiles = document.getElementById("picFile").files;
                const billingFiles = document.getElementById("billingFile").files;
                if (docFiles.length === 0 || picFiles.length === 0 || billingFiles.length === 0) {
                  Swal.fire({
                  icon: "error",
                  title: "Missing Attachments",
                  text: "Please upload all required attachments.",
                  confirmButtonColor: "#22c55e"
                  });
                  valid = false;
                }

                // Validate Terms and Conditions
                const terms = document.getElementById("terms");
                if (!terms.checked) {
                  Swal.fire({
                  icon: "error",
                  title: "Terms Not Accepted",
                  text: "You must agree to the Terms & Conditions.",
                  confirmButtonColor: "#22c55e"
                  });
                  valid = false;
                }

                // Validate hCaptcha
                const captcha = document.querySelector('textarea[name="h-captcha-response"]');
                if (!captcha || !captcha.value) {
                  document.getElementById("captchaError").classList.remove("hidden");
                  valid = false;
                } else {
                  document.getElementById("captchaError").classList.add("hidden");
                }

                if (!valid) {
                  // Scroll to first error
                  const firstError = form.querySelector(".ring-red-400");
                  if (firstError) firstError.scrollIntoView({ behavior: "smooth", block: "center" });
                  return false;
                }

                // If valid, submit the form
                form.requestSubmit();
                }
          </script>
        </section>
    </body>
  </html>